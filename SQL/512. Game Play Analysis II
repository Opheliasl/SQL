-- Write your PostgreSQL query statement below

######Subquery#########
select player_id, device_id
from Activity
where (player_id,event_date) in
(select player_id, min(event_date)
from Activity
group by player_id)


#####CTE Approach#####

with a as 
(select player_id, min(event_date) as first_login_date
from activity
group by player_id)

select a.player_id,b.device_id
from a
join activity b
on a.player_id = b.player_id
and a.first_login_date = b.event_date




Write a solution to report the device that is first logged in for each player.

Return the result table in any order.

The result format is in the following example.

 

Example 1:

Input: 
Activity table:
+-----------+-----------+------------+--------------+
| player_id | device_id | event_date | games_played |
+-----------+-----------+------------+--------------+
| 1         | 2         | 2016-03-01 | 5            |
| 1         | 2         | 2016-05-02 | 6            |
| 2         | 3         | 2017-06-25 | 1            |
| 3         | 1         | 2016-03-02 | 0            |
| 3         | 4         | 2018-07-03 | 5            |
+-----------+-----------+------------+--------------+
Output: 
+-----------+-----------+
| player_id | device_id |
+-----------+-----------+
| 1         | 2         |
| 2         | 3         |
| 3         | 1         |
+-----------+-----------+
