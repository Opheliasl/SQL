#####################PostgreSQL##########################
with a as(select distinct question_id, q_num,
sum(case when action='answer' then 1 else 0 end) as answered,
sum(case when action='show' then 1 else 0 end) as showed
from SurveyLog
group by 1,2)


select question_id as survey_log from (
select question_id, q_num,round(answered*1.0/showed,2) as rate 
from a
order by rate desc,q_num)
limit 1



############################################################
Example 1:

Input: 
SurveyLog table:
+----+--------+-------------+-----------+-------+-----------+
| id | action | question_id | answer_id | q_num | timestamp |
+----+--------+-------------+-----------+-------+-----------+
| 5  | show   | 285         | null      | 1     | 123       |
| 5  | answer | 285         | 124124    | 1     | 124       |
| 5  | show   | 369         | null      | 2     | 125       |
| 5  | skip   | 369         | null      | 2     | 126       |
+----+--------+-------------+-----------+-------+-----------+
Output: 
+------------+
| survey_log |
+------------+
| 285        |
+------------+
Explanation: 
Question 285 was showed 1 time and answered 1 time. The answer rate of question 285 is 1.0
Question 369 was showed 1 time and was not answered. The answer rate of question 369 is 0.0
Question 285 has the highest answer rate.
